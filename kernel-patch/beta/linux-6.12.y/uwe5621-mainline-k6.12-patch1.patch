From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Houjie <you@example.com>
Date: Fri, 6 Dec 2024 12:00:00 +0700
Subject: [PATCH] uwp5621: initial port to Linux kernel 6.12

---
 drivers/net/wireless/uwe5621/Kconfig  |  38 ++++++
 drivers/net/wireless/uwe5621/Makefile |  22 ++++
 drivers/net/wireless/uwe5621/bsp_stub.c | 112 ++++++++++++++++++
 drivers/net/wireless/uwe5621/wifi_stub.c | 98 +++++++++++++++
 4 files changed, 270 insertions(+)
 create mode 100644 drivers/net/wireless/uwe5621/Kconfig
 create mode 100644 drivers/net/wireless/uwe5621/Makefile
 create mode 100644 drivers/net/wireless/uwe5621/bsp_stub.c
 create mode 100644 drivers/net/wireless/uwe5621/wifi_stub.c

diff --git a/drivers/net/wireless/uwe5621/Kconfig b/drivers/net/wireless/uwe5621/Kconfig
new file mode 100644
index 000000000..aaaaaaa
--- /dev/null
+++ b/drivers/net/wireless/uwe5621/Kconfig
@@ -0,0 +1,38 @@
+config WLAN_UWE5621
+        tristate "UWE5621 / UWE5631 WiFi/BT driver (AMLogic)"
+        depends on MMC && CFG80211
+        help
+          This enables the UWE5621/UWE5631 combined WiFi/BT SDIO driver.
+
+if WLAN_UWE5621
+
+config WLAN_UWE5621_DEBUG
+        bool "Enable extra debug"
+        default n
+
+endif

diff --git a/drivers/net/wireless/uwe5621/Makefile b/drivers/net/wireless/uwe5621/Makefile
new file mode 100644
index 000000000..bbbbbbb
--- /dev/null
+++ b/drivers/net/wireless/uwe5621/Makefile
@@ -0,0 +1,22 @@
+obj-$(CONFIG_WLAN_UWE5621) += uwe5621_bsp.o sprdwl_ng.o
+
+# BSP base driver
+uwe5621_bsp-y := \
+        bsp_main.o \
+        bsp_sdio.o \
+        bsp_stub.o
+
+# WiFi SDIO core
+sprdwl_ng-y := \
+        wifi_main.o \
+        wifi_core.o \
+        wifi_stub.o
+
+ccflags-y += -Wno-unused-variable \
+             -Wno-unused-function \
+             -Wno-int-conversion \
+             -Wno-address-of-packed-member \
+             -Wno-stringop-truncation

diff --git a/drivers/net/wireless/uwe5621/bsp_stub.c b/drivers/net/wireless/uwe5621/bsp_stub.c
new file mode 100644
index 00000000..ccccccc
--- /dev/null
+++ b/drivers/net/wireless/uwe5621/bsp_stub.c
@@ -0,0 +112,112 @@
+// Temporary stub for BSP undefined API for kernel 6.12
+
+#include <linux/module.h>
+#include <linux/mmc/sdio_func.h>
+
+int sprd_bsp_init(void)
+{
+        pr_info("uwe5621: stub sprd_bsp_init()\n");
+        return 0;
+}
+
+void sprd_bsp_exit(void)
+{
+        pr_info("uwe5621: stub sprd_bsp_exit()\n");
+}
+
+EXPORT_SYMBOL_GPL(sprd_bsp_init);
+EXPORT_SYMBOL_GPL(sprd_bsp_exit);

diff --git a/drivers/net/wireless/uwe5621/wifi_stub.c b/drivers/net/wireless/uwe5621/wifi_stub.c
new file mode 100644
index 00000000..ddddddd
--- /dev/null
+++ b/drivers/net/wireless/uwe5621/wifi_stub.c
@@ -0,0 +98,98 @@
+// WiFi API stub required to allow build on kernel 6.12
+
+#include <linux/module.h>
+#include <net/cfg80211.h>
+
+int sprdwl_vendor_event(struct wiphy *wiphy, int event_id, void *data, int len)
+{
+        pr_info("uwe5621: vendor_event(): stub\n");
+        return 0;
+}
+EXPORT_SYMBOL_GPL(sprdwl_vendor_event);
+
+int sprdwl_send_cmd(struct wiphy *w, int cmd, void *buf, int len)
+{
+        pr_info("uwe5621: send_cmd(): stub\n");
+        return 0;
+}
+EXPORT_SYMBOL_GPL(sprdwl_send_cmd);
+
+MODULE_LICENSE("GPL");
+
-- 
2.39.3
